<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Inferência estatística | Estatística Computacional com R</title>
  <meta name="description" content="8 Inferência estatística | Estatística Computacional com R" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Inferência estatística | Estatística Computacional com R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Inferência estatística | Estatística Computacional com R" />
  
  
  

<meta name="author" content="Prof. Fernando P. Mayer" />
<meta name="author" content="Prof. Wagner H. Bonat" />
<meta name="author" content="Prof. Walmes M. Zeviani" />
<meta name="author" content="Prof. Elias T. Krainski" />
<meta name="author" content="Prof. Paulo J. Ribeiro Jr." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probabilidade-e-variáveis-aleatórias.html"/>
<link rel="next" href="documentos-dinâmicos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-66454501-6"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-66454501-6');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#para-quem-este-material-é-destinado"><i class="fa fa-check"></i>Para quem este material é destinado?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#informação-de-sessão"><i class="fa fa-check"></i>Informação de sessão</a></li>
</ul></li>
<li class="part"><span><b>I R básico</b></span></li>
<li class="chapter" data-level="1" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html"><i class="fa fa-check"></i><b>1</b> Computação científica e interação com o R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#interagindo-com-o-computador"><i class="fa fa-check"></i><b>1.1</b> Interagindo com o computador</a></li>
<li class="chapter" data-level="1.2" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#editores-de-texto"><i class="fa fa-check"></i><b>1.2</b> Editores de texto</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#editores-para-r"><i class="fa fa-check"></i><b>1.2.1</b> Editores para R</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#r"><i class="fa fa-check"></i><b>1.3</b> R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#configuração-inicial"><i class="fa fa-check"></i><b>1.3.1</b> Configuração inicial</a></li>
<li class="chapter" data-level="1.3.2" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#o-r-como-uma-calculadora"><i class="fa fa-check"></i><b>1.3.2</b> O R como uma calculadora</a></li>
<li class="chapter" data-level="1.3.3" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#para-onde-vão-os-resultados"><i class="fa fa-check"></i><b>1.3.3</b> Para onde vão os resultados?</a></li>
<li class="chapter" data-level="1.3.4" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#o-editor-de-scripts"><i class="fa fa-check"></i><b>1.3.4</b> O editor de scripts</a></li>
<li class="chapter" data-level="1.3.5" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#operadores-aritméticos"><i class="fa fa-check"></i><b>1.3.5</b> Operadores aritméticos</a></li>
<li class="chapter" data-level="1.3.6" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#ordens-de-execução"><i class="fa fa-check"></i><b>1.3.6</b> Ordens de execução</a></li>
<li class="chapter" data-level="" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#exercícios"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="1.3.7" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#salvando-resultados"><i class="fa fa-check"></i><b>1.3.7</b> “Salvando” resultados</a></li>
<li class="chapter" data-level="1.3.8" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#finalizando-o-programa"><i class="fa fa-check"></i><b>1.3.8</b> Finalizando o programa</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="computação-científica-e-interação-com-o-r.html"><a href="computação-científica-e-interação-com-o-r.html#referências"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html"><i class="fa fa-check"></i><b>2</b> Objetos e classes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#funções-e-argumentos"><i class="fa fa-check"></i><b>2.1</b> Funções e argumentos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#outros-tipos-de-argumentos"><i class="fa fa-check"></i><b>2.1.1</b> Outros tipos de argumentos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#mecanismos-de-ajuda"><i class="fa fa-check"></i><b>2.2</b> Mecanismos de ajuda</a></li>
<li class="chapter" data-level="2.3" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#criando-uma-função"><i class="fa fa-check"></i><b>2.3</b> Criando uma função</a></li>
<li class="chapter" data-level="" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#exercícios-1"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="2.4" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#objetos"><i class="fa fa-check"></i><b>2.4</b> Objetos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#nomes-de-objetos"><i class="fa fa-check"></i><b>2.4.1</b> Nomes de objetos</a></li>
<li class="chapter" data-level="2.4.2" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#gerenciando-a-área-de-trabalho"><i class="fa fa-check"></i><b>2.4.2</b> Gerenciando a área de trabalho</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#exercícios-2"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="2.5" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#tipos-e-classes-de-objetos"><i class="fa fa-check"></i><b>2.5</b> Tipos e classes de objetos</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#vetores-numéricos"><i class="fa fa-check"></i><b>2.5.1</b> Vetores numéricos</a></li>
<li class="chapter" data-level="2.5.2" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#outros-tipos-de-vetores"><i class="fa fa-check"></i><b>2.5.2</b> Outros tipos de vetores</a></li>
<li class="chapter" data-level="2.5.3" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#misturando-classes-de-objetos"><i class="fa fa-check"></i><b>2.5.3</b> Misturando classes de objetos</a></li>
<li class="chapter" data-level="2.5.4" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#valores-perdidos-e-especiais"><i class="fa fa-check"></i><b>2.5.4</b> Valores perdidos e especiais</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#exercícios-3"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="2.6" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#outras-classes"><i class="fa fa-check"></i><b>2.6</b> Outras classes</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#fator"><i class="fa fa-check"></i><b>2.6.1</b> Fator</a></li>
<li class="chapter" data-level="2.6.2" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#matriz"><i class="fa fa-check"></i><b>2.6.2</b> Matriz</a></li>
<li class="chapter" data-level="2.6.3" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#array"><i class="fa fa-check"></i><b>2.6.3</b> Array</a></li>
<li class="chapter" data-level="2.6.4" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#lista"><i class="fa fa-check"></i><b>2.6.4</b> Lista</a></li>
<li class="chapter" data-level="2.6.5" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#data-frame"><i class="fa fa-check"></i><b>2.6.5</b> Data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#atributos-de-objetos"><i class="fa fa-check"></i><b>2.7</b> Atributos de objetos</a></li>
<li class="chapter" data-level="" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#exercícios-4"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="" data-path="objetos-e-classes.html"><a href="objetos-e-classes.html#referências-1"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html"><i class="fa fa-check"></i><b>3</b> Indexação e seleção condicional</a>
<ul>
<li class="chapter" data-level="3.1" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#indexação"><i class="fa fa-check"></i><b>3.1</b> Indexação</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#indexação-de-vetores"><i class="fa fa-check"></i><b>3.1.1</b> Indexação de vetores</a></li>
<li class="chapter" data-level="" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#exercícios-5"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="3.1.2" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#indexação-de-matrizes"><i class="fa fa-check"></i><b>3.1.2</b> Indexação de matrizes</a></li>
<li class="chapter" data-level="3.1.3" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#indexação-de-listas"><i class="fa fa-check"></i><b>3.1.3</b> Indexação de listas</a></li>
<li class="chapter" data-level="3.1.4" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#indexação-de-data-frames"><i class="fa fa-check"></i><b>3.1.4</b> Indexação de data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#exercícios-6"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="3.2" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#seleção-condicional"><i class="fa fa-check"></i><b>3.2</b> Seleção condicional</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#seleção-condicional-em-vetores"><i class="fa fa-check"></i><b>3.2.1</b> Seleção condicional em vetores</a></li>
<li class="chapter" data-level="3.2.2" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#a-função-which"><i class="fa fa-check"></i><b>3.2.2</b> A função <code>which()</code></a></li>
<li class="chapter" data-level="" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#exercícios-7"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="3.2.3" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#seleção-condicional-em-data-frames"><i class="fa fa-check"></i><b>3.2.3</b> Seleção condicional em data frames</a></li>
<li class="chapter" data-level="" data-path="indexação-e-seleção-condicional.html"><a href="indexação-e-seleção-condicional.html#exercícios-8"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html"><i class="fa fa-check"></i><b>4</b> Entrada e saída de dados no R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#entrada-de-dados"><i class="fa fa-check"></i><b>4.1</b> Entrada de dados</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#entrada-de-dados-diretamente-no-r"><i class="fa fa-check"></i><b>4.1.1</b> Entrada de dados diretamente no R</a></li>
<li class="chapter" data-level="4.1.2" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#entrada-via-teclado"><i class="fa fa-check"></i><b>4.1.2</b> Entrada via teclado</a></li>
<li class="chapter" data-level="" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#exercícios-9"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="4.1.3" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#entrada-de-dados-em-arquivos-texto"><i class="fa fa-check"></i><b>4.1.3</b> Entrada de dados em arquivos texto</a></li>
<li class="chapter" data-level="" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#exercícios-10"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="4.1.4" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#entrada-de-dados-através-da-área-de-transferência"><i class="fa fa-check"></i><b>4.1.4</b> Entrada de dados através da área de transferência</a></li>
<li class="chapter" data-level="4.1.5" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#importando-dados-diretamente-de-planilhas"><i class="fa fa-check"></i><b>4.1.5</b> Importando dados diretamente de planilhas</a></li>
<li class="chapter" data-level="4.1.6" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#carregando-dados-já-disponíveis-no-r"><i class="fa fa-check"></i><b>4.1.6</b> Carregando dados já disponíveis no R</a></li>
<li class="chapter" data-level="4.1.7" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#importando-dados-de-outros-programas"><i class="fa fa-check"></i><b>4.1.7</b> Importando dados de outros programas</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#saída-de-dados-do-r"><i class="fa fa-check"></i><b>4.2</b> Saída de dados do R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#usando-a-função-write.table"><i class="fa fa-check"></i><b>4.2.1</b> Usando a função <code>write.table()</code></a></li>
<li class="chapter" data-level="" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#exercícios-11"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="4.2.2" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#usando-os-formatos-textual-e-binário-para-lerescrever-dados"><i class="fa fa-check"></i><b>4.2.2</b> Usando os formatos textual e binário para ler/escrever dados</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="entrada-e-saída-de-dados-no-r.html"><a href="entrada-e-saída-de-dados-no-r.html#informações-sobre-diretórios-e-arquivos"><i class="fa fa-check"></i><b>4.3</b> Informações sobre diretórios e arquivos</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="programando-com-dados.html"><a href="programando-com-dados.html"><i class="fa fa-check"></i><b>5</b> Programando com dados</a>
<ul>
<li class="chapter" data-level="5.1" data-path="programando-com-dados.html"><a href="programando-com-dados.html#estrutura-de-repetição-for"><i class="fa fa-check"></i><b>5.1</b> Estrutura de repetição <code>for()</code></a>
<ul>
<li class="chapter" data-level="" data-path="programando-com-dados.html"><a href="programando-com-dados.html#exercícios-12"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="programando-com-dados.html"><a href="programando-com-dados.html#estrutura-de-seleção-if"><i class="fa fa-check"></i><b>5.2</b> Estrutura de seleção <code>if()</code></a></li>
<li class="chapter" data-level="5.3" data-path="programando-com-dados.html"><a href="programando-com-dados.html#o-modo-r-vetorização"><i class="fa fa-check"></i><b>5.3</b> O modo R: vetorização</a>
<ul>
<li class="chapter" data-level="" data-path="programando-com-dados.html"><a href="programando-com-dados.html#exercícios-13"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="programando-com-dados.html"><a href="programando-com-dados.html#outras-estruturas-while-e-repeat"><i class="fa fa-check"></i><b>5.4</b> Outras estruturas: while e repeat</a>
<ul>
<li class="chapter" data-level="" data-path="programando-com-dados.html"><a href="programando-com-dados.html#exercícios-14"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Estatística</b></span></li>
<li class="chapter" data-level="6" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html"><i class="fa fa-check"></i><b>6</b> Análise exploratória de dados</a>
<ul>
<li class="chapter" data-level="6.1" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#o-conjunto-de-dados-milsa"><i class="fa fa-check"></i><b>6.1</b> O conjunto de dados <code>milsa</code></a></li>
<li class="chapter" data-level="6.2" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#análise-univariada"><i class="fa fa-check"></i><b>6.2</b> Análise univariada</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#variável-qualitativa-nominal"><i class="fa fa-check"></i><b>6.2.1</b> Variável Qualitativa Nominal</a></li>
<li class="chapter" data-level="6.2.2" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#variável-qualitativa-ordinal"><i class="fa fa-check"></i><b>6.2.2</b> Variável Qualitativa Ordinal</a></li>
<li class="chapter" data-level="6.2.3" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#variável-quantitativa-discreta"><i class="fa fa-check"></i><b>6.2.3</b> Variável quantitativa discreta</a></li>
<li class="chapter" data-level="6.2.4" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#variável-quantitativa-contínua"><i class="fa fa-check"></i><b>6.2.4</b> Variável quantitativa contínua</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#análise-bivariada"><i class="fa fa-check"></i><b>6.3</b> Análise Bivariada</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#qualitativa-vs-qualitativa"><i class="fa fa-check"></i><b>6.3.1</b> Qualitativa <em>vs</em> qualitativa</a></li>
<li class="chapter" data-level="6.3.2" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#qualitativa-vs-quantitativa"><i class="fa fa-check"></i><b>6.3.2</b> Qualitativa <em>vs</em> quantitativa</a></li>
<li class="chapter" data-level="6.3.3" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#quantitativa-vs-quantitativa"><i class="fa fa-check"></i><b>6.3.3</b> Quantitativa <em>vs</em> Quantitativa</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análise-exploratória-de-dados.html"><a href="análise-exploratória-de-dados.html#exercícios-15"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html"><i class="fa fa-check"></i><b>7</b> Probabilidade e variáveis aleatórias</a>
<ul>
<li class="chapter" data-level="7.1" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#conceitos-básicos-sobre-distribuições-de-probabilidade"><i class="fa fa-check"></i><b>7.1</b> Conceitos básicos sobre distribuições de probabilidade</a></li>
<li class="chapter" data-level="" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#exercícios-16"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="7.2" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#distribuições-de-probabilidade"><i class="fa fa-check"></i><b>7.2</b> Distribuições de Probabilidade</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#distribuição-normal"><i class="fa fa-check"></i><b>7.2.1</b> Distribuição Normal</a></li>
<li class="chapter" data-level="7.2.2" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#distribuição-binomial"><i class="fa fa-check"></i><b>7.2.2</b> Distribuição Binomial</a></li>
<li class="chapter" data-level="7.2.3" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#distribuição-de-poisson"><i class="fa fa-check"></i><b>7.2.3</b> Distribuição de Poisson</a></li>
<li class="chapter" data-level="7.2.4" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#distribuição-uniforme"><i class="fa fa-check"></i><b>7.2.4</b> Distribuição Uniforme</a></li>
<li class="chapter" data-level="7.2.5" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#a-função-sample"><i class="fa fa-check"></i><b>7.2.5</b> A função <code>sample()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#complementos-sobre-distribuições-de-probabilidade"><i class="fa fa-check"></i><b>7.3</b> Complementos sobre distribuições de probabilidade</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#probabilidades-e-integrais"><i class="fa fa-check"></i><b>7.3.1</b> Probabilidades e integrais</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probabilidade-e-variáveis-aleatórias.html"><a href="probabilidade-e-variáveis-aleatórias.html#exercícios-17"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inferência-estatística.html"><a href="inferência-estatística.html"><i class="fa fa-check"></i><b>8</b> Inferência estatística</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inferência-estatística.html"><a href="inferência-estatística.html#introdução-ao-pensamento-estatístico"><i class="fa fa-check"></i><b>8.1</b> Introdução ao pensamento estatístico</a></li>
<li class="chapter" data-level="8.2" data-path="inferência-estatística.html"><a href="inferência-estatística.html#estimação-pontual-e-intervalos-de-confiança"><i class="fa fa-check"></i><b>8.2</b> Estimação pontual e intervalos de confiança</a></li>
<li class="chapter" data-level="" data-path="inferência-estatística.html"><a href="inferência-estatística.html#exercícios-18"><i class="fa fa-check"></i>Exercícios</a></li>
<li class="chapter" data-level="8.3" data-path="inferência-estatística.html"><a href="inferência-estatística.html#teste-de-hipótese"><i class="fa fa-check"></i><b>8.3</b> Teste de hipótese</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inferência-estatística.html"><a href="inferência-estatística.html#teste-t-one-sample-t-test"><i class="fa fa-check"></i><b>8.3.1</b> Teste t (one sample t-test)</a></li>
<li class="chapter" data-level="8.3.2" data-path="inferência-estatística.html"><a href="inferência-estatística.html#teste-t-independent-two-sample-t-test"><i class="fa fa-check"></i><b>8.3.2</b> Teste t (independent two sample t-test)</a></li>
<li class="chapter" data-level="8.3.3" data-path="inferência-estatística.html"><a href="inferência-estatística.html#teste-t-variância-diferentes"><i class="fa fa-check"></i><b>8.3.3</b> Teste t variância diferentes</a></li>
<li class="chapter" data-level="8.3.4" data-path="inferência-estatística.html"><a href="inferência-estatística.html#teste-t-pareado"><i class="fa fa-check"></i><b>8.3.4</b> Teste t pareado</a></li>
<li class="chapter" data-level="8.3.5" data-path="inferência-estatística.html"><a href="inferência-estatística.html#teste-f"><i class="fa fa-check"></i><b>8.3.5</b> Teste F</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inferência-estatística.html"><a href="inferência-estatística.html#exercícios-19"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="appendix"><span><b>Apêndice</b></span></li>
<li class="chapter" data-level="A" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html"><i class="fa fa-check"></i><b>A</b> Documentos dinâmicos</a>
<ul>
<li class="chapter" data-level="A.1" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#literate-programming"><i class="fa fa-check"></i><b>A.1</b> Literate Programming</a></li>
<li class="chapter" data-level="A.2" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#literate-programming-no-r"><i class="fa fa-check"></i><b>A.2</b> Literate Programming no R</a></li>
<li class="chapter" data-level="A.3" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#markdown"><i class="fa fa-check"></i><b>A.3</b> Markdown</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#sintaxe-do-markdown"><i class="fa fa-check"></i><b>A.3.1</b> Sintaxe do Markdown</a></li>
<li class="chapter" data-level="A.3.2" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#escrevendo-um-documento-em-markdown"><i class="fa fa-check"></i><b>A.3.2</b> Escrevendo um documento em Markdown</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#pandoc"><i class="fa fa-check"></i><b>A.4</b> Pandoc</a></li>
<li class="chapter" data-level="A.5" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#documentos-dinâmicos-com-markdown-e-r"><i class="fa fa-check"></i><b>A.5</b> Documentos dinâmicos com Markdown e R</a></li>
<li class="chapter" data-level="A.6" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#r-markdown-e-knitr"><i class="fa fa-check"></i><b>A.6</b> R Markdown e knitr</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#metadados"><i class="fa fa-check"></i><b>A.6.1</b> Metadados</a></li>
<li class="chapter" data-level="A.6.2" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#convertendo-r-markdown-para-outros-formatos"><i class="fa fa-check"></i><b>A.6.2</b> Convertendo R Markdown para outros formatos</a></li>
<li class="chapter" data-level="A.6.3" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#opções-do-knitr"><i class="fa fa-check"></i><b>A.6.3</b> Opções do knitr</a></li>
<li class="chapter" data-level="A.6.4" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#citações"><i class="fa fa-check"></i><b>A.6.4</b> Citações</a></li>
<li class="chapter" data-level="A.6.5" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#extraindo-código-fonte"><i class="fa fa-check"></i><b>A.6.5</b> Extraindo código-fonte</a></li>
<li class="chapter" data-level="A.6.6" data-path="documentos-dinâmicos.html"><a href="documentos-dinâmicos.html#outras-linguagens"><i class="fa fa-check"></i><b>A.6.6</b> Outras linguagens</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="programação-orientada-a-objetos.html"><a href="programação-orientada-a-objetos.html"><i class="fa fa-check"></i><b>B</b> Programação Orientada a Objetos</a></li>
<li class="chapter" data-level="C" data-path="scripts.html"><a href="scripts.html"><i class="fa fa-check"></i><b>C</b> Scripts</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estatística Computacional com R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferência-estatística" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Inferência estatística<a href="inferência-estatística.html#inferência-estatística" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introdução-ao-pensamento-estatístico" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Introdução ao pensamento estatístico<a href="inferência-estatística.html#introdução-ao-pensamento-estatístico" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No contexto de análise e modelagem estatística o analista assume que todos os fenômenos aleatórios podem ser representados por distribuições de probabilidades, ou seja, um modelo estatístico. Tais distribuições são representações de como a variável aleatória deve se comportar na população. Em cursos de inferência estatística é usual a frase ‘’seja X uma variável aleatória de uma população normal com média <span class="math inline">\(\mu\)</span> e variância <span class="math inline">\(\sigma^2\)</span>’’.
Essa frase exemplifica a forma como o estatístico supõe que um certo fenômeno aleatório se comporta na população.</p>
<p>Considere o caso de uma pesquisa eleitoral onde potenciais eleitores são entrevistados sobre a sua intenção em votar (SUCESSO) ou não votar (FRACASSO) em um determinado candidato X. Note que pela estrutura do fenômeno aleatório o modelo Bernoulli é um candidato natural para modelar o comportamento da variável aleatória ‘’intenção de voto’’.
Suponha ainda que um conjunto de <span class="math inline">\(n\)</span> eleitores vão ser entrevistados e que a probabilidade de sucesso, ou seja, votar no candidato X seja constante para todos os entrevistados e denotada por <span class="math inline">\(p.\)</span> Nestas condições podemos estar interessados na variável aleatória Y que conta o número de sucessos (eleitores que vão votar em X) entre <span class="math inline">\(n\)</span> eleitores. Sendo assim, a distribuição de probabilidade de <span class="math inline">\(Y\)</span> é binomial com parâmetros <span class="math inline">\(n\)</span> e <span class="math inline">\(p\)</span> e sua função de probabilidade é dada por</p>
<p><span class="math display">\[
P(Y = y) = P(Y = y) = \binom{n}{y} p^y (1-p)^{n-y}.
\]</span>
Note que esta distribuição é completamente governada pelos valores de seus parâmetros, ou seja, <span class="math inline">\(n\)</span> e <span class="math inline">\(p\)</span>. Em geral <span class="math inline">\(n\)</span> é fixado e conhecido, por outro lado <span class="math inline">\(p\)</span> é desconhecido. Em termos práticos, o valor de <span class="math inline">\(p\)</span> é o que estamos interessados, uma vez que ele representa a proporção populacional de eleitores do candidato <span class="math inline">\(X\)</span>.</p>
<p>Se fossemos capazes de entrevistar todos os elementos da população de interesse, poderíamos facilmente calcular a proporção de eleitores de <span class="math inline">\(X\)</span> e plugar no modelo para calcular quaisquer tipos de probabilidades de interesse. No entanto na prática, muitas vezes entrevistar todos os elementos da população de interesse é impossível ou extremamente custoso. Nestas situações o problema que surge é como que baseado apenas em uma amostra da população de interesse podemos falar algo sobre toda a população. Este é o problema de uma das áreas da estatística chamada de inferência estatística.</p>
<p>O objetivo deste texto não é discutir inferência estatística em detalhes, mas apenas apresentar as principais ideias e ilustrar a sua implementação computacional utilizando o software R. Além disso, uma série de procedimentos pré-prontos estão disponíveis em R e devem ser apresentados de forma breve, uma vez que as ideias são similares apenas adaptadas à situações específicas.</p>
<p>O processo de inferência estatística começa com a especificação de uma distribuição de probabilidade para a variável aleatória de interesse. Neste caso, vamos definir a variável de interesse como sendo <span class="math inline">\(Y\)</span> - votar no candidato X. Note que esta é uma v.a binária, ou seja, apresenta apenas os valores <span class="math inline">\(0\)</span>-não vai votar no candidato X ou <span class="math inline">\(1\)</span> vai votar no candidato X. Neste caso, podemos especificar que <span class="math inline">\(Y \sim B(p)\)</span>, ou seja, <span class="math inline">\(Y\)</span> segue o modelo de Bernoulli com parâmetro <span class="math inline">\(p\)</span>. Importante lembrar que o espaço paramétrico de <span class="math inline">\(p\)</span> neste caso é o intervalo unitário, ou seja, <span class="math inline">\(p \in (0,1)\)</span>.</p>
<p>Uma vez com o modelo especificado precisamos de informações sobre o parâmetro populacional de interesse, neste caso <span class="math inline">\(p\)</span> que representa a proporção de eleitores do candidato X. Para obter informações sobre <span class="math inline">\(p\)</span> vamos coletar uma amostra da população de interesse e medir a variável de interesse. Neste caso, isso significa simplesmente perguntar se o eleitor vai ou não votar no candidato X. Em R podemos facilmente simular esta situação prática usando a função <span class="math inline">\(rbinom()\)</span>, conforme ilustra o código abaixo</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="inferência-estatística.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb350-2"><a href="inferência-estatística.html#cb350-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb350-3"><a href="inferência-estatística.html#cb350-3" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb350-4"><a href="inferência-estatística.html#cb350-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span></span></code></pre></div>
<p>Note que para simular uma amostra nós precisamos especificar o tamanho da amostra, neste caso <span class="math inline">\(n=10\)</span> o número de ensaios Bernoulli neste caso apenas <span class="math inline">\(1\)</span> e a probabilidade de sucesso (proporção populacional). É claro que na prática a proporção populacional é desconhecida, mas neste caso fixamos um valor para simular observações e o objetivo é apenas baseado nas realizações da variável aleatória <strong>descobrir</strong> ou <strong>inferir</strong> qual é o verdadeiro valor de <span class="math inline">\(p\)</span>. De forma mais geral os objetivos da inferência estatística são:</p>
<ul>
<li>Estimar <span class="math inline">\(p\)</span> baseado apenas na amostra (valor pontual)! Pense que deseja-se responder a pergunta: Quanto você acha que é a proporção de eleitores do candidato X na população?</li>
<li>Informar o quanto você acredita no valor estimado (intervalo de confiança).</li>
<li>Decidir sobre possíveis valores de p baseado apenas na amostra. Por exemplo, O candidato X vai ganhar (p &gt; 0,50)?</li>
</ul>
<p>Interessante notar que até este momento não fizemos nenhuma suposição em como as observações foram obtidas. No entanto, se supomos que as observações são independentes podemos facilmente obter a distribuição conjunta de todas as variáveis aleatórias envolvidas no modelo como o produto da distribuição de cada uma. Neste caso, todas as observações vêm de uma população Bernoulli com parâmetro <span class="math inline">\(p\)</span>. Assim, a distribuição conjunta é dada pelo seguinte produtório</p>
<p><span class="math display">\[
P(Y = y) = \prod_{i=1}^{n} p^{y_i} (1-p)^{1-y_i} = p^{\sum_{i=1}^n y_i} (1-p)^{n - \sum_{i=1}^n y_i}.
\]</span>
Uma forma alternativa é escrever a distribuição do número de sucessos em <span class="math inline">\(n\)</span> ensaios Bernoulli que é simplesmente uma distribuição binomial com parâmetros <span class="math inline">\(n\)</span> e <span class="math inline">\(p\)</span>, ou seja,</p>
<p><span class="math display">\[
P(Y = y) = P(Y = y) = \binom{n}{y} p^y (1-p)^{n-y}.
\]</span>
É importante enfatizar que após a amostra ser coletada o número <span class="math inline">\(y\)</span> de sucesso é fixo. Para a nossa amostra, temos <span class="math inline">\(y = 6\)</span>. Lembre-se que o <span class="math inline">\(n\)</span> foi fixado, assim para avaliar a equação acima em algum ponto, só precisamos fixar o valor de <span class="math inline">\(p\)</span>.</p>
<p>Agora vamos refletir sobre o que a equação acima está nos fornecendo. Suponha que em um primeiro momento você apenas precise decidir se <span class="math inline">\(p = 0.5\)</span> ou <span class="math inline">\(p = 0.8\)</span>. Como poderíamos usar o nosso modelo para tomar esta decisão?</p>
<p>Note que podemos calcular qual é a probabilidade de obter <span class="math inline">\(6\)</span> sucessos em <span class="math inline">\(n\)</span> ensaios supondo que <span class="math inline">\(p = 0.5\)</span> e também supondo que <span class="math inline">\(p = 0.8\)</span>. Vamos fazer estas contas</p>
<p><span class="math display">\[
P(Y = 6 | p = 0.5) = \binom{10}{6} 0.5^6 (1-0.5)^{10-6} = 0.205.
\]</span>
<span class="math display">\[
P(Y = 6 | p = 0.8) = \binom{10}{6} 0.8^6 (1-0.8)^{10-6} = 0.088.
\]</span>
Em R temos,</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="inferência-estatística.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb351-2"><a href="inferência-estatística.html#cb351-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2050781</span></span>
<span id="cb351-3"><a href="inferência-estatística.html#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.8</span>)</span>
<span id="cb351-4"><a href="inferência-estatística.html#cb351-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.08808038</span></span></code></pre></div>
<p>Baseado apenas nestas probabilidades, é possível observar que a probabilidade de observarmos <span class="math inline">\(6\)</span> sucessos em <span class="math inline">\(10\)</span> ensaios é mais provável quando <span class="math inline">\(p = 0.5\)</span> do que quando <span class="math inline">\(p = 0.8\)</span>. Neste caso podemos concluir que existe mais evidências em favor de <span class="math inline">\(p=0.5\)</span> do que em favor de <span class="math inline">\(p = 0.8\)</span>. Veja que fizemos uma espécie de pensamento inverso, observamos <span class="math inline">\(6\)</span> sucessos e agora estamos pensando, qual é o valor de <span class="math inline">\(p\)</span> mais compatível com esse valor. Além disso, a função de probabilidade conjunta vista como uma função do parâmetro ao invés da variável aleatória nos fornece exatamente essa noção de compatibilidade, ou seja, qual é o valor de <span class="math inline">\(p\)</span> mais compatível com as minhas observações.</p>
<p>Para enfatizar esta idéia vamos rescrever a função acima para enfatizar que a quantidade desconhecida agora é <span class="math inline">\(p\)</span> e não mais <span class="math inline">\(y\)</span>.</p>
<p><span class="math display">\[
L(p|y) = \binom{n}{y} p^y (1-p)^{n-y}.
\]</span>
A função acima é chamada de <strong>verossimilhança</strong> e é fundamental em todo o processo de inferência estatística. No caso de variáveis aleatórias discretas ela nos fornece a probabilidade de observar o que realmente foi observado dado um particular valor para o parâmetro de interesse. Particularizando para o nosso exemplo temos</p>
<p><span class="math display">\[
L(p|y) = \binom{10}{6} p^6 (1-p)^{10-6}.
\]</span>
Como dito a função de verossimilhança nos fornece uma medida de compatibilidade de um particular valor de <span class="math inline">\(p\)</span> com a amostra observada. Assim, é natural tomarmos como o nosso melhor ‘’chute’’ o valor mais compatível com a amostra observada, ou seja, o ponto de máximo da função de verossimilhança. Vamos fazer um gráfico para ilustrar esta ideia.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="inferência-estatística.html#cb352-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="cf">function</span>(p, n, y) {</span>
<span id="cb352-2"><a href="inferência-estatística.html#cb352-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span>
<span id="cb352-3"><a href="inferência-estatística.html#cb352-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb352-4"><a href="inferência-estatística.html#cb352-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb352-5"><a href="inferência-estatística.html#cb352-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">L</span>(x, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">6</span>), <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-374-1.png" width="672" style="display: block; margin: auto;" />
Na prática é mais comum trabalhar com o log da verossimilhança por conveniência computacional. Isso leva a chamada função de log-verossimilhança, cujo gráfico é apresentado abaixo para o nosso exemplo</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="inferência-estatística.html#cb353-1" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="cf">function</span>(p, n, y) {</span>
<span id="cb353-2"><a href="inferência-estatística.html#cb353-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y, <span class="at">size =</span> n, <span class="at">prob =</span> p, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb353-3"><a href="inferência-estatística.html#cb353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb353-4"><a href="inferência-estatística.html#cb353-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb353-5"><a href="inferência-estatística.html#cb353-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ll</span>(x, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">6</span>), <span class="fl">0.4</span>, <span class="fl">0.8</span>)</span>
<span id="cb353-6"><a href="inferência-estatística.html#cb353-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(y))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-375-1.png" width="672" style="display: block; margin: auto;" />
Não é dificil mostrar usando ferramentas padrões de cálculo diferencial que o ponto de máximo ocorre em <span class="math inline">\(\hat{p} = y/n\)</span>, ou seja, na proporção amostral de eleitores do candidato X.</p>
<p>Com essa ideia simples resolvemos o primeiro objetivo da inferência estatística que consiste em dizer qual valor achamos razoável para <span class="math inline">\(p\)</span> dado a amostra que coletamos.
O próximo objetivo é dizer o quanto acreditamos neste valor. Note que uma vez que temos a função de verossimilhança ou log-verossmilhança basta olhar para a função para responder a tal pergunta. O ponto de máximo é o mais compatível, porém valores ao redor do máximo também apresentam uma boa compatibilidade com a amostra e portanto são bons candidatos a valor de <span class="math inline">\(p\)</span>. Essa ideia pode ser resumida por fazer um corte horizontal na função de log-verossimilhança. Assim, todos os pontos acima do corte são bons candidatos a verdadeiro valor de <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="inferência-estatística.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ll</span>(x, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">6</span>), <span class="fl">0.4</span>, <span class="fl">0.8</span>)</span>
<span id="cb354-2"><a href="inferência-estatística.html#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="sc">-</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-376-1.png" width="672" style="display: block; margin: auto;" />
Entretanto, onde fazer tal corte não é uma tarefa simples e explicar como e por que fazer isso em detalhes está fora do escopo deste material. Esta é a ideia por traz da definição do que se chama popularmente de intervalo de confiança.
Uma forma alternativa é fazer um gráfico da função de verossimilhança relativa, definida como a verossimilhança divida pela verossimilhança no ponto de máximo,
<span class="math display">\[
LR(p) = L(p)/L(\hat{p}).
\]</span></p>
<p>Neste caso um intervalo pode ser obtido por definir algum valor entre <span class="math inline">\(0\)</span> e <span class="math inline">\(1\)</span> para obter intervalos não vazios. Por exemplo, podemos definir que uma compatibilidade de pelo menos 0.4 com a amostra é necessário para que um valor seja parte do intervalo. Ilustrando graficamente temos,</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="inferência-estatística.html#cb355-1" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span> <span class="cf">function</span>(p, p_hat, n, y) {</span>
<span id="cb355-2"><a href="inferência-estatística.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">L</span>(<span class="at">p =</span> p, <span class="at">n =</span> n, <span class="at">y =</span> y)<span class="sc">/</span><span class="fu">L</span>(<span class="at">p =</span> p_hat, <span class="at">n =</span> n, <span class="at">y =</span> y)</span>
<span id="cb355-3"><a href="inferência-estatística.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb355-4"><a href="inferência-estatística.html#cb355-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb355-5"><a href="inferência-estatística.html#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">LR</span>(x, <span class="at">p_hat =</span> <span class="fl">0.6</span>, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">6</span>), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb355-6"><a href="inferência-estatística.html#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-377-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Por fim, o último objetivo da inferência consiste em decidir se um determinado valor hipotético para <span class="math inline">\(p\)</span> é ou não compatível com a amostra observada. Note que o valor mais compatível é o máximo da verossimilhança, assim para decidir se um valor é ou não compatível com a amostra, basta verificar se ele está perto ou longe do valor que tem maior compatibilidade. Esta ideia é o que esta por traz do que se chama de teste de hipóteses e é ilustrada abaixo.</p>
<p><img src="figures/unnamed-chunk-378-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="estimação-pontual-e-intervalos-de-confiança" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Estimação pontual e intervalos de confiança<a href="inferência-estatística.html#estimação-pontual-e-intervalos-de-confiança" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O processo de estimação pontual consiste em encontrar um valor ao qual chamamos de estimativa do verdadeiro valor do parâmetro, em nosso exemplo o parâmetro <span class="math inline">\(p\)</span> da distribuição Bernoulli. Como discutido anteriormente a função de verossimilhança nos fornece uma forma intuitiva de obter tal valor que no caso da distribuição de Bernoulli é simplesmente a proporção amostral, <span class="math inline">\(\hat{p} = y/n\)</span>.</p>
<p>O próximo passo é encontrar um intervalo de confiança para o parâmetro <span class="math inline">\(p\)</span>. Neste texto vamos enfatizar o pensamento frequentista de probabilidade para motivar a construção do intervalo de confiança.</p>
<p>Importante salientar que <span class="math inline">\(Y\)</span> é uma variável aleatória cuja observações são denotadas por <span class="math inline">\(y\)</span>. Nossa estimativa de <span class="math inline">\(p\)</span> é o valor <span class="math inline">\(\hat{p} = y/n\)</span> que é uma função dos valores observados. Agora suponha que o experimento seja refeito um número grande vezes. O que vai acontecer com <span class="math inline">\(\hat{p}\)</span>? Vamos fazer um experimento computacional para ilustrar esta situação.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="inferência-estatística.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb356-2"><a href="inferência-estatística.html#cb356-2" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb356-3"><a href="inferência-estatística.html#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb356-4"><a href="inferência-estatística.html#cb356-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb356-5"><a href="inferência-estatística.html#cb356-5" aria-hidden="true" tabindex="-1"></a>  p.hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb356-6"><a href="inferência-estatística.html#cb356-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="inferência-estatística.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb357-2"><a href="inferência-estatística.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(p.hat)), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb357-3"><a href="inferência-estatística.html#cb357-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Proporção observada&quot;</span>,</span>
<span id="cb357-4"><a href="inferência-estatística.html#cb357-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-380-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>A Figura acima mostra que mesmo o verdadeiro valor de <span class="math inline">\(p\)</span> sendo 0.5 existe uma probabilidade razoável de observarmos <span class="math inline">\(\hat{p} = 0.4\)</span> e <span class="math inline">\(\hat{p} = 0.6\)</span> em uma amostra de tamanho 10. Porém, quando nos distanciamos de <span class="math inline">\(0.5\)</span> a probabilidade de observar <span class="math inline">\(\hat{p}\)</span> mais extremos como 0.1 ou 0.9 é pequena. No geral, a incerteza com relação ao valor de <span class="math inline">\(p\)</span> é grande. Para diminuir tal incerteza precisamos ganhar mais informações sobre o valor de <span class="math inline">\(p\)</span> e para isso precisamos de mais amostras.</p>
<p>Note que para cada possível amostra coletada o valor de <span class="math inline">\(\hat{p}\)</span> é alterado. Isso é decorrente de <span class="math inline">\(\hat{p}\)</span> ser também uma função da variável aleatória <span class="math inline">\(Y\)</span>. Para enfatizar isso usamos a notação <span class="math inline">\(\hat{p} = Y/n\)</span> e neste caso chamamos <span class="math inline">\(\hat{p}\)</span> de estimador do valor de <span class="math inline">\(p\)</span>. Pensando desta forma <span class="math inline">\(\hat{p}\)</span> é também uma variável aleatória e consequentemente ele deve ter uma distribuição de probabilidade que pode ser resumida, por exemplo, usando esperança e variância.</p>
<p>A Figura abaixo mostra o efeito do tamanho da amostra sobre a distribuição amostral do estimador <span class="math inline">\(\hat{p}\)</span>.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="inferência-estatística.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb358-2"><a href="inferência-estatística.html#cb358-2" aria-hidden="true" tabindex="-1"></a>p.hat.list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb358-3"><a href="inferência-estatística.html#cb358-3" aria-hidden="true" tabindex="-1"></a>amostra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>,<span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb358-4"><a href="inferência-estatística.html#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb358-5"><a href="inferência-estatística.html#cb358-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb358-6"><a href="inferência-estatística.html#cb358-6" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb358-7"><a href="inferência-estatística.html#cb358-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb358-8"><a href="inferência-estatística.html#cb358-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(amostra[j], <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb358-9"><a href="inferência-estatística.html#cb358-9" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]][i,] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb358-10"><a href="inferência-estatística.html#cb358-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb358-11"><a href="inferência-estatística.html#cb358-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p.hat.list[[j]], <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Amostra&quot;</span>, amostra[j]), </span>
<span id="cb358-12"><a href="inferência-estatística.html#cb358-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Proporção observada&quot;</span>,</span>
<span id="cb358-13"><a href="inferência-estatística.html#cb358-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb358-14"><a href="inferência-estatística.html#cb358-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/unnamed-chunk-381-1.png" width="99%" style="display: block; margin: auto;" /></p>
<p>Note que quanto maior a amostra a distribuição amostral fica mais concentrada ao redor do verdadeiro valor de <span class="math inline">\(p\)</span>. Isso é decorrente da Lei dos grandes números. Além disso, note que a distribuição é muito parecida com a distribuição normal, um resultado conhecido como Teorema Central do Limite.</p>
<p>A idéia de intervalo de confiança é simplesmente olhar para a distribuição amostral e responder a pergunta: Qual o intervalo em que <span class="math inline">\(\hat{p}\)</span> tem uma probabilidade, digamos <span class="math inline">\((1-\alpha)\)</span> de pertencer?</p>
<p>O valor de <span class="math inline">\(\alpha\)</span> deve ser especificado e alguns valores populares são <span class="math inline">\(0.05\)</span> e <span class="math inline">\(0.01\)</span>.
A Figura abaixo ilustra esta ideia.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="inferência-estatística.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb359-2"><a href="inferência-estatística.html#cb359-2" aria-hidden="true" tabindex="-1"></a>p.hat.list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb359-3"><a href="inferência-estatística.html#cb359-3" aria-hidden="true" tabindex="-1"></a>amostra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb359-4"><a href="inferência-estatística.html#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb359-5"><a href="inferência-estatística.html#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb359-6"><a href="inferência-estatística.html#cb359-6" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb359-7"><a href="inferência-estatística.html#cb359-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb359-8"><a href="inferência-estatística.html#cb359-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(amostra[j], <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb359-9"><a href="inferência-estatística.html#cb359-9" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]][i,] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb359-10"><a href="inferência-estatística.html#cb359-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb359-11"><a href="inferência-estatística.html#cb359-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p.hat.list[[j]], <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Amostra&quot;</span>, amostra[j]), </span>
<span id="cb359-12"><a href="inferência-estatística.html#cb359-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Densidade&quot;</span>,</span>
<span id="cb359-13"><a href="inferência-estatística.html#cb359-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb359-14"><a href="inferência-estatística.html#cb359-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span> <span class="fu">c</span>(<span class="fu">quantile</span>(p.hat.list[[j]], <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb359-15"><a href="inferência-estatística.html#cb359-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/unnamed-chunk-382-1.png" width="99%" style="display: block; margin: auto;" /></p>
<p>Temos um procedimento bastante simples para obter os limites do intervalo de confiança, porém tal procedimento depende de sermos capazes de realizar o experimento um número grande de vezes. Na prática só temos uma amostra coletada e baseado apenas nesta amostra precisamos inferir sobre <span class="math inline">\(p\)</span>. É neste ponto que entra o fato de <span class="math inline">\(\hat{p}\)</span> ser uma variável aleatória. Este fato permite que exploremos sua distribuição mesmo sem realizar um grande número de experimentos.</p>
<p>De forma geral obter a distribuição de probabilidade de um estimador não é uma tarefa trivial, porém o Teorema Central do Limite nos fornece uma boa aproximação, ao menos para grandes amostras. O Teorema Central do limite em sua versão mais simples é como segue:</p>
<ul>
<li>Teorema Lindeberg-Levy: Seja <span class="math inline">\(Y_1, \ldots, Y_n\)</span> uma amostra iid
com <span class="math inline">\(E(Y_i) = \mu\)</span> e <span class="math inline">\(V(Y_i) = \sigma^2 &lt; \infty\)</span>.
Então,
<span class="math display">\[ \sqrt{n}\left ( \frac{\bar{Y} - \mu}{\sigma} \right ) \overset{D}{\to} Z \sim N(0,1), \quad \text{para} \quad n \to \infty.\]</span></li>
<li>Isso significa que, para todo <span class="math inline">\(y \in \Re\)</span>,
<span class="math display">\[ P(Y_n \leq y) \to \Phi (y) \quad \text{quando} \quad n \to \infty,\]</span> onde
<span class="math display">\[ \Phi(y) = \int_{-\infty}^y \phi(z) dz \quad \text{e} \quad
\phi(z) = \frac{1}{\sqrt{2\pi}} \exp \left ( -\frac{1}{2} z^2 \right ).\]</span></li>
<li>Forma alternativa: <span class="math inline">\(\bar{Y} \sim N(\mu, \sigma^2/n).\)</span></li>
</ul>
<p>Particularizando para o nosso exemplo temos que:</p>
<ul>
<li>Estimador de máxima verossimilhança <span class="math inline">\(\hat{p} = \frac{Y}{n}.\)</span></li>
<li>Usando as propriedades da distribuição binomial, temos
<span class="math display">\[E(\hat{p}) = E(Y/n) = \frac{1}{n}E(Y) = \frac{np}{n} = p.\]</span>
<span class="math display">\[Var(\hat{p}) = Var(Y/n) = \frac{1}{n^2}Var(Y) = \frac{np(1-p)}{n^2} = \frac{p(1-p)}{n}.\]</span></li>
<li>Usando o TLC, temos
<span class="math display">\[\hat{p} \sim N(p, \frac{p(1-p)}{n}).\]</span></li>
</ul>
<p>Vamos fazer uma ilustração computacional deste importante resultado.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="inferência-estatística.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb360-2"><a href="inferência-estatística.html#cb360-2" aria-hidden="true" tabindex="-1"></a>p.hat.list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb360-3"><a href="inferência-estatística.html#cb360-3" aria-hidden="true" tabindex="-1"></a>amostra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb360-4"><a href="inferência-estatística.html#cb360-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb360-5"><a href="inferência-estatística.html#cb360-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb360-6"><a href="inferência-estatística.html#cb360-6" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb360-7"><a href="inferência-estatística.html#cb360-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb360-8"><a href="inferência-estatística.html#cb360-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(amostra[j], <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb360-9"><a href="inferência-estatística.html#cb360-9" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]][i,] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb360-10"><a href="inferência-estatística.html#cb360-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb360-11"><a href="inferência-estatística.html#cb360-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(p.hat.list[[j]], <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Amostra&quot;</span>, amostra[j]), </span>
<span id="cb360-12"><a href="inferência-estatística.html#cb360-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Densidade&quot;</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb360-13"><a href="inferência-estatística.html#cb360-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">0.5</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.5</span>)<span class="sc">/</span>amostra[j])), <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb360-14"><a href="inferência-estatística.html#cb360-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/unnamed-chunk-383-1.png" width="99%" style="display: block; margin: auto;" /></p>
<p>Agora usando resultados convencionais da distribuição normal podemos encontrar os limites do intervalo de confiança. Para o caso binomial o intervalo é dado por
<span class="math display">\[\hat{p} \pm Z_{\alpha/2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\]</span>
onde <span class="math inline">\(Z_{\alpha/2}\)</span> é o quantil da distribuição normal padrão com <span class="math inline">\(\alpha/2\)</span> probabilidade.</p>
<p>Cálculos similares mostram que para os casos da média de uma distribuição normal e Poisson os intervalos ficam dados por:</p>
<ul>
<li><p>Intervalo de confiança: Caso Normal
<span class="math display">\[\hat{\mu} \pm Z_{\alpha/2} \sqrt{\frac{\hat{\sigma}^2}{n}},\]</span>
onde <span class="math inline">\(\hat{\sigma}^2 = \sum_{i=1}^n \frac{(y_i - \hat{\mu})^2}{n-1}\)</span>.</p></li>
<li><p>Intervalo de confiança: Caso Poisson
<span class="math display">\[\hat{\lambda} \pm Z_{\alpha/2} \sqrt{\frac{\hat{\lambda}}{n}},\]</span>
onde <span class="math inline">\(\hat{\lambda} = \sum_{i=1}^n \frac{y_i}{n}.\)</span></p></li>
</ul>
<p>O intervalo de confiança deve ser interpretado sempre com muito cuidado. A interpretação frequentista é a seguinte: Se o experimento for repetido um número <span class="math inline">\(n\)</span> de vezes e para cada realização obtermos o intervalo de confiança, esperamos que <span class="math inline">\((1-\alpha)\%\)</span> dos intervalos contenham o verdadeiro valor do parâmetro. Note que a variável aleatória é o próprio intervalo de confiança.</p>
<p>O código abaixo ilustra computacionalmente tal interpretação.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="inferência-estatística.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb361-2"><a href="inferência-estatística.html#cb361-2" aria-hidden="true" tabindex="-1"></a>results_wald <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">100</span>)</span>
<span id="cb361-3"><a href="inferência-estatística.html#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb361-4"><a href="inferência-estatística.html#cb361-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb361-5"><a href="inferência-estatística.html#cb361-5" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb361-6"><a href="inferência-estatística.html#cb361-6" aria-hidden="true" tabindex="-1"></a>  v_hat <span class="ot">&lt;-</span> (p_hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat))<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb361-7"><a href="inferência-estatística.html#cb361-7" aria-hidden="true" tabindex="-1"></a>  temp_wald <span class="ot">&lt;-</span> <span class="fu">c</span>(p_hat <span class="sc">-</span>  <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(v_hat), p_hat <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(v_hat))</span>
<span id="cb361-8"><a href="inferência-estatística.html#cb361-8" aria-hidden="true" tabindex="-1"></a>  results_wald[i,] <span class="ot">&lt;-</span> temp_wald</span>
<span id="cb361-9"><a href="inferência-estatística.html#cb361-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb361-10"><a href="inferência-estatística.html#cb361-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-11"><a href="inferência-estatística.html#cb361-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervalo Wald</span></span>
<span id="cb361-12"><a href="inferência-estatística.html#cb361-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="fl">0.30</span>,<span class="fl">0.72</span>) <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(p), <span class="at">xlab =</span> <span class="st">&quot;Ensaio&quot;</span>)</span>
<span id="cb361-13"><a href="inferência-estatística.html#cb361-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.50</span>)</span>
<span id="cb361-14"><a href="inferência-estatística.html#cb361-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb361-15"><a href="inferência-estatística.html#cb361-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="fu">c</span>(i),results_wald[i,<span class="dv">1</span>],<span class="fu">c</span>(i),results_wald[i,<span class="dv">2</span>],<span class="at">code=</span><span class="dv">3</span>,<span class="at">angle=</span><span class="dv">90</span>,<span class="at">length=</span><span class="fl">0.03</span>,</span>
<span id="cb361-16"><a href="inferência-estatística.html#cb361-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">ifelse</span>(results_wald[i,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">|</span> results_wald[i,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;lightgray&quot;</span>))</span>
<span id="cb361-17"><a href="inferência-estatística.html#cb361-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/unnamed-chunk-384-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Exemplo 1</strong> No caso do candidato X suponha que é de interesse apresentar uma estimativa intervalar para a proporção de eleitores de X na população. Assumindo que a estimativa amostral foi de <span class="math inline">\(0,60\)</span> (seis sucessos em dez ensaios) o intervalo com <span class="math inline">\(95\%\)</span> de confiança é dado por
<span class="math display">\[
\hat{p}_I = 0,6 - 1.96\sqrt{0,6(1-0,6)/10} = 0.296 \quad \text{e} \quad \hat{p}_S = 0,6 - 1.96\sqrt{0,6(1-0,6)/10} = 0.904.
\]</span></p>
<p><strong>Exemplo 2</strong> Num grupo de pacientes, o nível de colesterol é uma variável aleatória com distribuição Normal, de média desconhecida e variância <span class="math inline">\(64 (mg/ml)^2\)</span>.
- Para uma amostra de 46 indivíduos que forneceu nível médio de colesterol de 120 <span class="math inline">\(mg/ml\)</span>, construa o intervalo de confiança de <span class="math inline">\(88\%\)</span>.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="inferência-estatística.html#cb362-1" aria-hidden="true" tabindex="-1"></a>media <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb362-2"><a href="inferência-estatística.html#cb362-2" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">64</span>)</span>
<span id="cb362-3"><a href="inferência-estatística.html#cb362-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">46</span></span>
<span id="cb362-4"><a href="inferência-estatística.html#cb362-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.12</span></span>
<span id="cb362-5"><a href="inferência-estatística.html#cb362-5" aria-hidden="true" tabindex="-1"></a>mu_I <span class="ot">&lt;-</span> media <span class="sc">-</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">46</span>)</span>
<span id="cb362-6"><a href="inferência-estatística.html#cb362-6" aria-hidden="true" tabindex="-1"></a>mu_S <span class="ot">&lt;-</span> media <span class="sc">+</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">46</span>)</span>
<span id="cb362-7"><a href="inferência-estatística.html#cb362-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mu_I, mu_S)</span>
<span id="cb362-8"><a href="inferência-estatística.html#cb362-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">118.1661</span> <span class="fl">121.8339</span></span></code></pre></div>
</div>
<div id="exercícios-18" class="section level2 unnumbered hasAnchor">
<h2>Exercícios<a href="inferência-estatística.html#exercícios-18" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Por analogia a produtos similares, o tempo de reação de um novo medicamento pode ser considerado como tendo distribuição Normal com desvio padrão igual a 2 minutos (a média desconhecida). Vinte pacientes foram sorteados, receberam o medicamento e tiveram seu tempo de reação anotado. Os dados foram os seguintes (em minutos): <span class="math inline">\(2,9; 3,4; 3,5; 4,1; 4,6; 4,7; 4,5; 3,8; 5,3; 4,9; 4,8; 5,7; 5,8; 5,0; 3,4; 5,9; 6,3; 4,6; 5,5\)</span> e <span class="math inline">\(6,2\)</span>. Obtenha um intervalo de confiança para o tempo médio de reação. Use <span class="math inline">\(96\%\)</span> de confiança.</p></li>
<li><p>Uma amostra de 25 observações de uma Normal <span class="math inline">\((\mu, 16)\)</span> foi coletada e forneceu uma média amostral de 8. Construa intervalos de confiança com <span class="math inline">\(80\%\)</span>, <span class="math inline">\(85\%\)</span>, <span class="math inline">\(90\%\)</span> e <span class="math inline">\(95\%\)</span> de confiança. Comente as diferenças encontradas.</p></li>
<li><p>Numa pesquisa com 50 eleitores, o candidato José João obteve <span class="math inline">\(0,34\)</span> da preferência dos eleitores. Construa, para a confiança de <span class="math inline">\(94\%\)</span> o intervalo de confiança para a proporção de votos a serem recebidos pelo candidato mencionado.</p></li>
<li><p>Considere a seguinte amostra da distribuição de Poisson de parâmetro <span class="math inline">\(\lambda\)</span>. Proponha um estimador pontual e intervalar para <span class="math inline">\(\lambda\)</span> usando o método de máxima verossimilhança. Implemente seu método em R. Faça um estudo de simulação para ilustrar a distribuição aproximada deste estimador.</p></li>
<li><p>O número de atendimentos em um pronto-socorro pode ser modelado por uma distribuição de Poisson de parâmetro <span class="math inline">\(\lambda\)</span>. Suponha que o interesse seja modelar o número de atendimentos por hora e que para um conjunto de <span class="math inline">\(30\)</span> horas o número de atendimentos por hora foi contado e as observações são mostradas abaixo.</p></li>
</ol>
<pre><code># A tibble: 3 × 1
  `matrix(y, 3, 10)`[,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
                   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1                      6    11     8     8     9    12     7     9     9     9
2                     10    13    12    13     8     6    13     9     9     6
3                      7     4     8     8     5     3    12    16     8     5</code></pre>
<p>O seu interesse é dimensionar o número de médicos para este pronto socorro.
Suponha que um médico consegue atender até quatro pessoas em um período de uma hora. A politica do hospital especifica que se deve manter um contigente de médicos necessários para atender a demanda em <span class="math inline">\(95\%\)</span> dos dias. Especifique quantos médicos devem estar de plantão para que a politica do hospital seja respeitada.</p>
</div>
<div id="teste-de-hipótese" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Teste de hipótese<a href="inferência-estatística.html#teste-de-hipótese" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O último objetivo da inferência estatística é a construção de testes de hipóteses.
Uma hipótese é qualquer afirmativa sobre uma propriedade da população.
Um teste de hipótese é um procedimento para avaliar uma afirmativa sobre uma propriedade da população. Em termos estatísticos uma hipótese estatística é qualquer afirmativa sobre um parâmetro da distribuição de probabilidade.</p>
<p>Voltando ao nosso exemplo do candidato X, podemos estar interessados por exemplo em saber se a proporção de votos no candidato X é maior que 0.5, o que implicaria que ele ganharia a eleição. Em termos de distribuição de probabilidade essa é uma afirmativa acerca do valor do parâmetro <span class="math inline">\(p\)</span>. Sendo assim, enunciamos as hipóteses da seguinte forma:</p>
<p><span class="math display">\[H_0: p = \frac{1}{2} \quad vs \quad H_1: p \neq \frac{1}{2}.\]</span>
Nesta notação <span class="math inline">\(H_0\)</span> é chamada de hipótese nula. Por outro lado, <span class="math inline">\(H_1\)</span> é chamada de hipótese alternativa.</p>
<p>Para construir um teste de hipótese usamos novamente o pensamento frequentista de probabilidade, ou seja, considere que é possível realizar o experimento um número indefinido de vezes. Para cada uma destas realizações obtemos uma estimativa para o valor de <span class="math inline">\(p\)</span> digamos <span class="math inline">\(\hat{p}\)</span>. Verique quais valores realizados de <span class="math inline">\(\hat{p}\)</span> são <strong>razoáveis</strong> de ocorrer sob a hipótese nula. No caso da hipótese nula ser verdadeira podemos facilmente gerar dados do fenômeno de interesse. Neste caso, vamos realizar o experimento <span class="math inline">\(1000\)</span> vezes e ver como se comporta nosso estimador.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="inferência-estatística.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb364-2"><a href="inferência-estatística.html#cb364-2" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb364-3"><a href="inferência-estatística.html#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb364-4"><a href="inferência-estatística.html#cb364-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb364-5"><a href="inferência-estatística.html#cb364-5" aria-hidden="true" tabindex="-1"></a>  p.hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb364-6"><a href="inferência-estatística.html#cb364-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb364-7"><a href="inferência-estatística.html#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb364-8"><a href="inferência-estatística.html#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(p.hat)), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb364-9"><a href="inferência-estatística.html#cb364-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Proporção observada&quot;</span>,</span>
<span id="cb364-10"><a href="inferência-estatística.html#cb364-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-387-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Veja que mesmo a hipótese nula sendo verdadeira existe uma probabilidade
não desprezível de observarmos <span class="math inline">\(8\)</span> eleitores de X em <span class="math inline">\(10\)</span> eleitores.
A incerteza associada a decisão no caso de apenas <span class="math inline">\(10\)</span> observações é
grande. Para diminuir a incerteza precisamos de mais informação o que conseguimos aumentanto a amostra. A Figura abaixo ilustra esta situação</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="inferência-estatística.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb365-2"><a href="inferência-estatística.html#cb365-2" aria-hidden="true" tabindex="-1"></a>p.hat.list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb365-3"><a href="inferência-estatística.html#cb365-3" aria-hidden="true" tabindex="-1"></a>amostra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>,<span class="dv">500</span>)</span>
<span id="cb365-4"><a href="inferência-estatística.html#cb365-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb365-5"><a href="inferência-estatística.html#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb365-6"><a href="inferência-estatística.html#cb365-6" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb365-7"><a href="inferência-estatística.html#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb365-8"><a href="inferência-estatística.html#cb365-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(amostra[j], <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb365-9"><a href="inferência-estatística.html#cb365-9" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]][i,] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb365-10"><a href="inferência-estatística.html#cb365-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb365-11"><a href="inferência-estatística.html#cb365-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p.hat.list[[j]], <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Amostra&quot;</span>, amostra[j]), </span>
<span id="cb365-12"><a href="inferência-estatística.html#cb365-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Proporção observada&quot;</span>,</span>
<span id="cb365-13"><a href="inferência-estatística.html#cb365-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb365-14"><a href="inferência-estatística.html#cb365-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/unnamed-chunk-388-1.png" width="99%" style="display: block; margin: auto;" /></p>
<p>O procedimento é bastante intuivo e parecido com a construção de intervalos de confiança. No entanto, no caso de teste de hipóteses precisamos tomar uma decisão. Sendo assim, a ideia é construir uma região de valores para os quais você aceitará (ou não rejeitará) a hipótese nula esta região é chamada de região de aceitação ou não rejeição de <span class="math inline">\(H_0\)</span>.
A Figura abaixo ilustra a construção da região de rejeição</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="inferência-estatística.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb366-2"><a href="inferência-estatística.html#cb366-2" aria-hidden="true" tabindex="-1"></a>p.hat.list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb366-3"><a href="inferência-estatística.html#cb366-3" aria-hidden="true" tabindex="-1"></a>amostra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>,<span class="dv">500</span>)</span>
<span id="cb366-4"><a href="inferência-estatística.html#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">1.2</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">0.6</span>, <span class="dv">0</span>))</span>
<span id="cb366-5"><a href="inferência-estatística.html#cb366-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb366-6"><a href="inferência-estatística.html#cb366-6" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb366-7"><a href="inferência-estatística.html#cb366-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb366-8"><a href="inferência-estatística.html#cb366-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(amostra[j], <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb366-9"><a href="inferência-estatística.html#cb366-9" aria-hidden="true" tabindex="-1"></a>  p.hat.list[[j]][i,] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb366-10"><a href="inferência-estatística.html#cb366-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb366-11"><a href="inferência-estatística.html#cb366-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p.hat.list[[j]], <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Amostra&quot;</span>, amostra[j]), </span>
<span id="cb366-12"><a href="inferência-estatística.html#cb366-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Proporção observada&quot;</span>,</span>
<span id="cb366-13"><a href="inferência-estatística.html#cb366-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb366-14"><a href="inferência-estatística.html#cb366-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span> <span class="fu">c</span>(<span class="fu">quantile</span>(p.hat.list[[j]], <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb366-15"><a href="inferência-estatística.html#cb366-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/unnamed-chunk-389-1.png" width="99%" style="display: block; margin: auto;" /></p>
<p>Novamente em termos práticos não temos como repetir o experimento um número grande vezes. Assim, recorremos novamente ao Teorema Central do Limite e estabelecemos a região critica de forma aproximada usando a aproximação Gaussiana. No caso Bernoulli, este procedimento resulta na seguinte estatística de teste</p>
<ul>
<li>Estatística do teste caso Bernoulli</li>
</ul>
<p><span class="math display">\[
Z = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0(1-p_0)}{n}}} \sim N(0,1).
\]</span></p>
<p>O procedimento aqui descrito em linhas gerais é bastante genérico e perfaz toda a estatística. No entanto está fora do escopo deste material discutir tais procedimentos em detalhes. Na sequência apresentamos o resumo de alguns casos notáveis de testes de hipóteses que aparecem com frequência em cursos de estatística básica.</p>
<p><strong>Exemplo 1</strong> Considere que seja de interesse verificar se existe evidências que o candidato <span class="math inline">\(X\)</span> vai ganhar as eleições. Em termos estatístico isso significa que</p>
<ul>
<li><span class="math inline">\(H_0: p = 0.5\)</span> contra <span class="math inline">\(H_1:p &gt; 0.5.\)</span></li>
</ul>
<p>Suponha que adotamos <span class="math inline">\(5\%\)</span> de significância.
Neste caso a região crítica é unilateral, e tem a seguinte forma
<span class="math display">\[p_c = 0.5 + 1.64\sqrt{0.25/10} = 0.76.\]</span>
Vamos fazer um gráfico da região de aceitação e rejeição e verificar onde a proporção amostral está localizada para concluir o teste.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="inferência-estatística.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">0.25</span><span class="sc">/</span><span class="dv">10</span>)), <span class="fl">0.1</span>, <span class="fl">0.9</span>, </span>
<span id="cb367-2"><a href="inferência-estatística.html#cb367-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Densidade&quot;</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(p)))</span>
<span id="cb367-3"><a href="inferência-estatística.html#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.5</span><span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.95</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">0.25</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb367-4"><a href="inferência-estatística.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">6</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-390-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Lembre-se que a proporção amostral foi de <span class="math inline">\(0.6\)</span> em <span class="math inline">\(10\)</span> entrevistas.
Assim, vemos claramente que não temos evidências para rejeitar <span class="math inline">\(H_0\)</span>.
Neste caso não temos evidências para dizer que o candidato X irá ganhar a eleição.</p>
<ul>
<li>Estatística do teste caso Normal</li>
</ul>
<p>No caso de população Normal, a estatística de teste para testar <span class="math inline">\(H_0:\mu = \mu_0\)</span> contra <span class="math inline">\(H_1: \mu \neq \mu_0\)</span> com variância conhecida <span class="math inline">\(\sigma^2\)</span> é dada por</p>
<p><span class="math display">\[
\frac{\hat{y} -  \mu_0}{\sigma/\sqrt{n}} \sim N(0,1)
\]</span>
onde <span class="math inline">\(\mu_0\)</span> é o valor especificado sob a hipótese nula. Neste caso a região crítica para testes bilaterais toma a seguinte forma:</p>
<p><span class="math display">\[
y_I = \mu_0 - Z_{\alpha/2} \sqrt{\sigma^2 / n}\quad \text{e} \quad y_S = \mu_0 + Z_{\alpha/2} \sqrt{\sigma^2 / n}.
\]</span></p>
<p><strong>Exemplo 2</strong> (Magalhães e Lima, pg. 252). Um pesquisador deseja estudar o efeito de certa substância no tempo de reação de seres vivos a um certo tipo de estímulo. Um experimento é desenvolvido com cobaias que são inoculadas com a substância e submetidas a um estimulo elétrico, com seus tempos de reação (em segundos) anotados. Os seguintes valores foram obtidos: <span class="math inline">\(9,1;\quad 9,3;\quad 7,2;\quad 7,5;\quad 13,3;\quad 10,9;\quad 7,2;\quad 9,9;\quad 8,0;\quad 8,6\)</span>. Admite-se que o tempo de reação segue, em geral o modelo Normal com média 8 e desvio padrão <span class="math inline">\(\sigma = 2\)</span> segundos. O pesquisador desconfia, entretanto, que o tempo médio sofre alteração por influência da substância. Neste caso as hipóteses de interesse são:</p>
<ul>
<li><span class="math inline">\(H_0:\)</span> as cobais apresentam tempo de reação padrão;</li>
<li><span class="math inline">\(H_1:\)</span> as cobais tem o tempo de reação alterado.</li>
</ul>
<p>Em termos de modelo estatístico, tais hipóteses são traduzidas para afirmações acerca do parâmetro <span class="math inline">\(\mu\)</span>.</p>
<ul>
<li><span class="math inline">\(H_0: \mu = 8\)</span> contra <span class="math inline">\(H_1: \mu \neq 8\)</span>.</li>
</ul>
<p>Neste caso a região crítica para <span class="math inline">\(\alpha = 0,05\)</span> fica dada por
<span class="math display">\[y_I = 8 - 1,96\sqrt{4/10} = 6,76 \quad \text{e} \quad y_S = 8 + 1,96 \sqrt{4/10} = 9,24.\]</span>
Vamos agora obter a média amostral e concluir o teste.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="inferência-estatística.html#cb368-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">9.1</span>,<span class="fl">9.3</span>,<span class="fl">7.2</span>,<span class="fl">7.5</span>,<span class="fl">13.3</span>,<span class="fl">10.9</span>,<span class="fl">7.2</span>,<span class="fl">9.9</span>,<span class="fl">8.0</span>,<span class="fl">8.6</span>)</span>
<span id="cb368-2"><a href="inferência-estatística.html#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb368-3"><a href="inferência-estatística.html#cb368-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">9.1</span></span></code></pre></div>
<p>Ilustrando a região crítica</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="inferência-estatística.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>)), <span class="dv">6</span>, <span class="dv">10</span>, </span>
<span id="cb369-2"><a href="inferência-estatística.html#cb369-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Densidade&quot;</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(y)))</span>
<span id="cb369-3"><a href="inferência-estatística.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">8</span><span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>), <span class="dv">8</span><span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>) ))</span>
<span id="cb369-4"><a href="inferência-estatística.html#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(x), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-392-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Como o valor observado da média amostral pertence a região de aceitação de <span class="math inline">\(H_0\)</span>, aceitamos a hipóteses <span class="math inline">\(H_0\)</span> ao nível de significância de <span class="math inline">\(5\%\)</span>. Em outras palavras, concluímos que o tempo de reação das cobais submetidas à substância não é alterado.</p>
<div id="teste-t-one-sample-t-test" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Teste t (one sample t-test)<a href="inferência-estatística.html#teste-t-one-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Teste t (one sample t-test)
<ul>
<li>Hipóteses: <span class="math inline">\(H_0: \mu = \mu_0 \quad \times \quad H_1: \mu \neq \mu_0.\)</span></li>
<li>Estatística de teste: <span class="math inline">\(\frac{\bar{y} - \mu_0}{\hat{\sigma}/\sqrt{n}} \sim t_{n-1}.\)</span></li>
</ul></li>
<li>Suposições: Para o teste ser exato, precisamos
<ul>
<li><span class="math inline">\(Y \sim N(\mu, \sigma^2)\)</span> iid.</li>
<li><span class="math inline">\(\hat{\sigma}^2 = \sum_{i=1}^n (y_i - \bar{y})^2/n-1\)</span>.</li>
</ul></li>
<li>Podem ser razoavelmente relaxadas para grandes amostras.</li>
<li>Neste caso a distribuição t não é mais necessária.</li>
<li>Assintóticamente a estatística tem distribuição Normal padrão.</li>
</ul>
<p><strong>Exemplo 3</strong>: (Magalhães e Lima, pg. 259). Deseja-se investigar se uma certa moléstia que ataca o rim altera o consumo de oxigênio desse orgão. Para indivíduos sadios, admite-se que esse consumo tem distribuição Normal com média 12 <span class="math inline">\(cm^3/min\)</span>. Os valores medidos em cinco pacientes com a moléstia foram: <span class="math inline">\(14,4;12,9;15,0;13,7;\)</span> e <span class="math inline">\(13,5\)</span>. Qual seria a conclusão, ao nível de 1<span class="math inline">\(\%\)</span> de significância?</p>
<p>O teste de interesse é</p>
<ul>
<li><span class="math inline">\(H_0:\)</span> A moléstia não altera a média de consumo renal de oxigênio;</li>
<li><span class="math inline">\(H_1:\)</span> Indivíduos portadores da moléstia têm média alterada.</li>
</ul>
<p>Passando as hipóteses em termos do nosso modelo</p>
<ul>
<li><span class="math inline">\(H_0: \mu = 12\)</span> contra <span class="math inline">\(H_1: \mu \neq 12\)</span>.</li>
</ul>
<p>O R conta com uma função especifica para este teste, conforme mostra o código abaixo.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="inferência-estatística.html#cb370-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">14.4</span>,<span class="fl">12.9</span>,<span class="dv">15</span>,<span class="fl">13.7</span>,<span class="fl">13.5</span>)</span>
<span id="cb370-2"><a href="inferência-estatística.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> y, <span class="at">mu =</span> <span class="dv">12</span>)</span>
<span id="cb370-3"><a href="inferência-estatística.html#cb370-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-4"><a href="inferência-estatística.html#cb370-4" aria-hidden="true" tabindex="-1"></a>    One Sample t<span class="sc">-</span>test</span>
<span id="cb370-5"><a href="inferência-estatística.html#cb370-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-6"><a href="inferência-estatística.html#cb370-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  y</span>
<span id="cb370-7"><a href="inferência-estatística.html#cb370-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fl">5.2099</span>, df <span class="ot">=</span> <span class="dv">4</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.006472</span></span>
<span id="cb370-8"><a href="inferência-estatística.html#cb370-8" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">12</span></span>
<span id="cb370-9"><a href="inferência-estatística.html#cb370-9" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb370-10"><a href="inferência-estatística.html#cb370-10" aria-hidden="true" tabindex="-1"></a> <span class="fl">12.88745</span> <span class="fl">14.91255</span></span>
<span id="cb370-11"><a href="inferência-estatística.html#cb370-11" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb370-12"><a href="inferência-estatística.html#cb370-12" aria-hidden="true" tabindex="-1"></a>mean of x </span>
<span id="cb370-13"><a href="inferência-estatística.html#cb370-13" aria-hidden="true" tabindex="-1"></a>     <span class="fl">13.9</span> </span></code></pre></div>
<p>Neste caso rejeitamos <span class="math inline">\(H_0\)</span> em favor de <span class="math inline">\(H_1\)</span>. Note que a função retorna uma série de informações úteis. Temos o tipo de teste realizado, o valor da estatística <span class="math inline">\(t\)</span> e os graus de liberdade do teste ao lado do <span class="math inline">\(p-valor\)</span>. A função já apresenta a conclusão do teste e por reporta o intervalo de confiança para a média amostral e a média amostral.</p>
</div>
<div id="teste-t-independent-two-sample-t-test" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Teste t (independent two sample t-test)<a href="inferência-estatística.html#teste-t-independent-two-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Teste t duas populações independentes variâncias iguais (independent two sample t-test)
<ul>
<li>Hipóteses: <span class="math inline">\(H_0: \mu_1 = \mu_2 \quad \times \quad H_1: \mu_1 \neq \mu_2.\)</span></li>
<li>Estatística de teste: <span class="math inline">\(\frac{\bar{y}_1 - \bar{y}_2}{s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} \sim t_{n_1 + n_2-2}.\)</span></li>
<li><span class="math inline">\(s_p = \sqrt{\frac{(n_1 - 1)s^2_1 + (n_2 - 1)s^2_2}{n_1 + n_2 -2}}\)</span> se variâncias assumidas iguais e tamanhos de amostras diferentes.</li>
</ul></li>
</ul>
<p><strong>Exemplo 4</strong> Digitadores são treinados em uma empresa em duas turmas distintas. Na primeira, denominada Turma J, utiliza-se um métodos japonês de ensino, ao passo que na segunda turma, denominada Turma A, utiliza-se um método alemão. Deseja-se comparar os dois métodos e para tanto, 16 alunos de cada turma foram escolhidos aleatoriamente e uma mesma tarefa foi atribuída a cada um. Ao final do experimento, o tempo gasto na realização da tarefa, para cada aluno, foi anotado. No processo, dois computadores utilizados pelos alunos selecionados da turma J e três da turma A apresentaram problemas que impediram a realização da tarefa; o tamanho da amostra foi assim reduzido para 14 e 13 respectivamente, para as turmas J e A. Os dados são os seguintes:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="inferência-estatística.html#cb371-1" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">14</span>,<span class="dv">13</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">12</span>,<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>)</span>
<span id="cb371-2"><a href="inferência-estatística.html#cb371-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">16</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">17</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">11</span>,<span class="dv">17</span>,<span class="dv">14</span>,<span class="cn">NA</span>)</span>
<span id="cb371-3"><a href="inferência-estatística.html#cb371-3" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(J,A)</span>
<span id="cb371-4"><a href="inferência-estatística.html#cb371-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 14 × 2</span></span>
<span id="cb371-5"><a href="inferência-estatística.html#cb371-5" aria-hidden="true" tabindex="-1"></a>       J     A</span>
<span id="cb371-6"><a href="inferência-estatística.html#cb371-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb371-7"><a href="inferência-estatística.html#cb371-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>    <span class="dv">10</span>    <span class="dv">15</span></span>
<span id="cb371-8"><a href="inferência-estatística.html#cb371-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>    <span class="dv">13</span>    <span class="dv">12</span></span>
<span id="cb371-9"><a href="inferência-estatística.html#cb371-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>     <span class="dv">9</span>    <span class="dv">18</span></span>
<span id="cb371-10"><a href="inferência-estatística.html#cb371-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>    <span class="dv">10</span>    <span class="dv">16</span></span>
<span id="cb371-11"><a href="inferência-estatística.html#cb371-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>    <span class="dv">14</span>    <span class="dv">15</span></span>
<span id="cb371-12"><a href="inferência-estatística.html#cb371-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>    <span class="dv">13</span>    <span class="dv">17</span></span>
<span id="cb371-13"><a href="inferência-estatística.html#cb371-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>    <span class="dv">10</span>    <span class="dv">17</span></span>
<span id="cb371-14"><a href="inferência-estatística.html#cb371-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>    <span class="dv">15</span>    <span class="dv">15</span></span>
<span id="cb371-15"><a href="inferência-estatística.html#cb371-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>    <span class="dv">12</span>    <span class="dv">16</span></span>
<span id="cb371-16"><a href="inferência-estatística.html#cb371-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">10</span>    <span class="dv">17</span></span>
<span id="cb371-17"><a href="inferência-estatística.html#cb371-17" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>     <span class="dv">9</span>    <span class="dv">11</span></span>
<span id="cb371-18"><a href="inferência-estatística.html#cb371-18" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>    <span class="dv">10</span>    <span class="dv">17</span></span>
<span id="cb371-19"><a href="inferência-estatística.html#cb371-19" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>    <span class="dv">13</span>    <span class="dv">14</span></span>
<span id="cb371-20"><a href="inferência-estatística.html#cb371-20" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>    <span class="dv">14</span>    <span class="cn">NA</span></span></code></pre></div>
<p>Apesar de não conhecidas, as variâncias populacionais são assumidas iguais com base em estudos anteriores. Suponha que o interesse é testar</p>
<ul>
<li><span class="math inline">\(H_0: \mu_J = \mu_A\)</span> contra <span class="math inline">\(H_1: \mu_J \neq \mu_A\)</span>.</li>
</ul>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="inferência-estatística.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> J, <span class="at">y =</span> A, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb372-2"><a href="inferência-estatística.html#cb372-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-3"><a href="inferência-estatística.html#cb372-3" aria-hidden="true" tabindex="-1"></a>    Two Sample t<span class="sc">-</span>test</span>
<span id="cb372-4"><a href="inferência-estatística.html#cb372-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-5"><a href="inferência-estatística.html#cb372-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  J and A</span>
<span id="cb372-6"><a href="inferência-estatística.html#cb372-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="sc">-</span><span class="fl">4.7965</span>, df <span class="ot">=</span> <span class="dv">25</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">6.313e-05</span></span>
<span id="cb372-7"><a href="inferência-estatística.html#cb372-7" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb372-8"><a href="inferência-estatística.html#cb372-8" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb372-9"><a href="inferência-estatística.html#cb372-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span><span class="fl">5.450501</span> <span class="sc">-</span><span class="fl">2.175872</span></span>
<span id="cb372-10"><a href="inferência-estatística.html#cb372-10" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb372-11"><a href="inferência-estatística.html#cb372-11" aria-hidden="true" tabindex="-1"></a>mean of x mean of y </span>
<span id="cb372-12"><a href="inferência-estatística.html#cb372-12" aria-hidden="true" tabindex="-1"></a> <span class="fl">11.57143</span>  <span class="fl">15.38462</span> </span></code></pre></div>
</div>
<div id="teste-t-variância-diferentes" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Teste t variância diferentes<a href="inferência-estatística.html#teste-t-variância-diferentes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Teste t duas populações independentes variâncias diferentes (independent two sample t-test)
<ul>
<li>Hipóteses: <span class="math inline">\(H_0: \mu_1 = \mu_2 \quad \times \quad H_1: \mu_1 \neq \mu_2.\)</span></li>
<li>Estatística de teste: <span class="math inline">\(\frac{\bar{y}_1 - \bar{y}_2}{s_{\delta}} \sim t_{df}.\)</span></li>
<li><span class="math inline">\(s_{\delta} = \sqrt{\frac{s^1}{n_1} + \frac{s^2}{n_2}}\)</span> se variâncias diferentes e tamanhos de amostras diferentes.</li>
<li>Graus de liberdade <span class="math inline">\(df = \frac{\left ( \frac{s^2_1}{n_1} + \frac{s^2_2}{n_2} \right )}{\frac{(s^2_1/n_1)^2}{n_1 - 1} + \frac{(s^2_2/n_2)^2}{n_2 - 1}}.\)</span></li>
</ul></li>
</ul>
<p><strong>Exemplo 5</strong> Considere o exemplo dos digitadores, porém agora sem assumir que as variâncias populacionais são iguais. O teste t neste caso pode ser realizado da seguinte forma:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="inferência-estatística.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> J, <span class="at">y =</span> A, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb373-2"><a href="inferência-estatística.html#cb373-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-3"><a href="inferência-estatística.html#cb373-3" aria-hidden="true" tabindex="-1"></a>    Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb373-4"><a href="inferência-estatística.html#cb373-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-5"><a href="inferência-estatística.html#cb373-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  J and A</span>
<span id="cb373-6"><a href="inferência-estatística.html#cb373-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="sc">-</span><span class="fl">4.7967</span>, df <span class="ot">=</span> <span class="fl">24.856</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">6.399e-05</span></span>
<span id="cb373-7"><a href="inferência-estatística.html#cb373-7" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb373-8"><a href="inferência-estatística.html#cb373-8" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb373-9"><a href="inferência-estatística.html#cb373-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span><span class="fl">5.450930</span> <span class="sc">-</span><span class="fl">2.175444</span></span>
<span id="cb373-10"><a href="inferência-estatística.html#cb373-10" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb373-11"><a href="inferência-estatística.html#cb373-11" aria-hidden="true" tabindex="-1"></a>mean of x mean of y </span>
<span id="cb373-12"><a href="inferência-estatística.html#cb373-12" aria-hidden="true" tabindex="-1"></a> <span class="fl">11.57143</span>  <span class="fl">15.38462</span> </span></code></pre></div>
</div>
<div id="teste-t-pareado" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Teste t pareado<a href="inferência-estatística.html#teste-t-pareado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Teste t duas populações dependentes (paired two sample t-test)
<ul>
<li>Hipóteses: <span class="math inline">\(H_0: \mu_D = 0 \quad \times \quad H_1: \mu_D \neq 0.\)</span></li>
<li>Estatística de teste: <span class="math inline">\(\frac{\bar{y}_D - 0}{\hat{\sigma}_D/\sqrt{n}} \sim t_{n-1}.\)</span></li>
<li>Neste caso, <span class="math inline">\(\mu_D\)</span> e <span class="math inline">\(\hat{\sigma}_D\)</span> são a média e o desvio-padrão da diferença entre <span class="math inline">\(y_1\)</span> e <span class="math inline">\(y_2\)</span>.</li>
</ul></li>
</ul>
<p><strong>Exemplo 6</strong> Uma distribuidora de combustíveis deseja verificar se um novo tipo de gasolina é eficaz na revitalização de moteores velhos. Com esse objetivo, seleciona 12 automóveis de um mesmo modelo com mais de 8 anos de uso e, após regulagem de seus motores, verifica o consumo de combustível. Em seguida, o carro é abastecido com o novo tipo de combustível durante 15 semanas, e uma nova aferição do consumo é feita. Defina as variáveis aleatórias <span class="math inline">\(X_i\)</span> e <span class="math inline">\(Y_i\)</span> como o rendimento do automóvel <span class="math inline">\(i\)</span> respectivamente antes e após as 15 semanas. Vemos que <span class="math inline">\(X_i\)</span> e <span class="math inline">\(Y_i\)</span> foram medidas em uma mesma unidade amostral e, assim, é razoável assumir que exista alguma dependência entre elas. Os valores observados, em <span class="math inline">\(km/l\)</span>, junto com as diferenças <span class="math inline">\(D_i = Y_i - X_i\)</span>, para os 12 automóveis são apresentados na tabela a seguir.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="inferência-estatística.html#cb374-1" aria-hidden="true" tabindex="-1"></a>Apos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.6</span>,<span class="fl">8.8</span>,<span class="fl">9.9</span>,<span class="fl">9.5</span>,<span class="fl">11.6</span>,<span class="fl">9.1</span>,<span class="fl">10.6</span>,<span class="fl">10.8</span>,<span class="fl">13.4</span>,<span class="fl">10.6</span>,<span class="fl">10.5</span>,<span class="fl">11.4</span>)</span>
<span id="cb374-2"><a href="inferência-estatística.html#cb374-2" aria-hidden="true" tabindex="-1"></a>Antes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">8.1</span>,<span class="fl">7.9</span>,<span class="fl">6.8</span>,<span class="fl">7.8</span>,<span class="fl">7.6</span>,<span class="fl">7.9</span>,<span class="fl">5.7</span>,<span class="fl">8.4</span>,<span class="dv">8</span>,<span class="fl">9.5</span>,<span class="dv">8</span>,<span class="fl">6.8</span>)</span>
<span id="cb374-3"><a href="inferência-estatística.html#cb374-3" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> Apos <span class="sc">-</span> Antes</span>
<span id="cb374-4"><a href="inferência-estatística.html#cb374-4" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(Apos, Antes, D)</span>
<span id="cb374-5"><a href="inferência-estatística.html#cb374-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 12 × 3</span></span>
<span id="cb374-6"><a href="inferência-estatística.html#cb374-6" aria-hidden="true" tabindex="-1"></a>    Apos Antes     D</span>
<span id="cb374-7"><a href="inferência-estatística.html#cb374-7" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb374-8"><a href="inferência-estatística.html#cb374-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">11.6</span>   <span class="fl">8.1</span>   <span class="fl">3.5</span></span>
<span id="cb374-9"><a href="inferência-estatística.html#cb374-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>   <span class="fl">8.8</span>   <span class="fl">7.9</span>   <span class="fl">0.9</span></span>
<span id="cb374-10"><a href="inferência-estatística.html#cb374-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>   <span class="fl">9.9</span>   <span class="fl">6.8</span>   <span class="fl">3.1</span></span>
<span id="cb374-11"><a href="inferência-estatística.html#cb374-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>   <span class="fl">9.5</span>   <span class="fl">7.8</span>   <span class="fl">1.7</span></span>
<span id="cb374-12"><a href="inferência-estatística.html#cb374-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="fl">11.6</span>   <span class="fl">7.6</span>   <span class="dv">4</span>  </span>
<span id="cb374-13"><a href="inferência-estatística.html#cb374-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>   <span class="fl">9.1</span>   <span class="fl">7.9</span>   <span class="fl">1.2</span></span>
<span id="cb374-14"><a href="inferência-estatística.html#cb374-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">10.6</span>   <span class="fl">5.7</span>   <span class="fl">4.9</span></span>
<span id="cb374-15"><a href="inferência-estatística.html#cb374-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="fl">10.8</span>   <span class="fl">8.4</span>   <span class="fl">2.4</span></span>
<span id="cb374-16"><a href="inferência-estatística.html#cb374-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">13.4</span>   <span class="dv">8</span>     <span class="fl">5.4</span></span>
<span id="cb374-17"><a href="inferência-estatística.html#cb374-17" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">10.6</span>   <span class="fl">9.5</span>   <span class="fl">1.1</span></span>
<span id="cb374-18"><a href="inferência-estatística.html#cb374-18" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="fl">10.5</span>   <span class="dv">8</span>     <span class="fl">2.5</span></span>
<span id="cb374-19"><a href="inferência-estatística.html#cb374-19" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="fl">11.4</span>   <span class="fl">6.8</span>   <span class="fl">4.6</span></span></code></pre></div>
<p>Queremos testar as hipóteses
- <span class="math inline">\(H_0:\)</span> <span class="math inline">\(\mu_D = 0\)</span> (a intervenção não produz efeito)
- <span class="math inline">\(H_1:\)</span> <span class="math inline">\(\mu_D \neq 0\)</span> (a intervenção produz algum efeito)</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="inferência-estatística.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> Apos, <span class="at">y =</span> Antes, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-2"><a href="inferência-estatística.html#cb375-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3"><a href="inferência-estatística.html#cb375-3" aria-hidden="true" tabindex="-1"></a>    Paired t<span class="sc">-</span>test</span>
<span id="cb375-4"><a href="inferência-estatística.html#cb375-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5"><a href="inferência-estatística.html#cb375-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  Apos and Antes</span>
<span id="cb375-6"><a href="inferência-estatística.html#cb375-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fl">6.5396</span>, df <span class="ot">=</span> <span class="dv">11</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">4.195e-05</span></span>
<span id="cb375-7"><a href="inferência-estatística.html#cb375-7" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true mean difference is not equal to <span class="dv">0</span></span>
<span id="cb375-8"><a href="inferência-estatística.html#cb375-8" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb375-9"><a href="inferência-estatística.html#cb375-9" aria-hidden="true" tabindex="-1"></a> <span class="fl">1.951609</span> <span class="fl">3.931724</span></span>
<span id="cb375-10"><a href="inferência-estatística.html#cb375-10" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb375-11"><a href="inferência-estatística.html#cb375-11" aria-hidden="true" tabindex="-1"></a>mean difference </span>
<span id="cb375-12"><a href="inferência-estatística.html#cb375-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.941667</span> </span></code></pre></div>
</div>
<div id="teste-f" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Teste F<a href="inferência-estatística.html#teste-f" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Teste F para igualdade de variâncias.
<ul>
<li>Hipóteses: <span class="math inline">\(H_0: \sigma^2_1 = \sigma^2_2 \quad \times H_1: \sigma^2_1 \neq \sigma^2_2\)</span>.</li>
<li>Estatística de teste: <span class="math inline">\(F = \frac{s^2_1}{s^2_2} \sim F_{(n_1-1)(n_2-1)}\)</span>.</li>
<li>Suposições <span class="math inline">\(Y_1 \sim N(\mu_1, \sigma^2_1)\)</span> e <span class="math inline">\(Y_2 \sim N(\mu_2, \sigma^2_2)\)</span>.</li>
<li>Em geral, este teste é conhecido por ser sensível a suposição de normalidade.</li>
</ul></li>
<li>Se normalidade é duvidosa, use o teste para variâncias diferentes.</li>
<li>Poder e tamanho do teste podem ser altamente sensíveis a suposições.</li>
<li>Para grandes amostras o TCL fornece uma opção robusta a não-normalidade.</li>
<li><strong>Regra do dedão</strong> Amostra maior que <span class="math inline">\(30\)</span> TCL funciona bem!</li>
<li>Mas cuidado!! depende da situação!!</li>
</ul>
<p><strong>Exemplo 7</strong> Sabe-se que em uma região do país a altura média é de <span class="math inline">\(1,68\)</span>m, com variância de <span class="math inline">\(0,30m^2\)</span>. Um pesquisador acredita que a alimentação rotineira em uma cidade litorânea, sendo diferente da região como um todo, contribui para que as pessoas apresentem alturas mais homogêneas, apesar de não alterar a altura média da população da cidade. Para verificar sua suspeita, ele coletou um amostra de 31 pessoas e obteve
a seguinte amostra:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="inferência-estatística.html#cb376-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.77</span>, <span class="fl">1.72</span>, <span class="fl">2.39</span>, <span class="fl">1.95</span>, <span class="fl">1.69</span>, <span class="fl">1.84</span>, <span class="fl">1.86</span>, <span class="fl">1.57</span>, <span class="fl">1.38</span>, <span class="fl">1.47</span>, <span class="fl">1.94</span>, </span>
<span id="cb376-2"><a href="inferência-estatística.html#cb376-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.15</span>, <span class="fl">1.93</span>, <span class="fl">2.18</span>, <span class="fl">1.37</span>, <span class="fl">1.56</span>, <span class="fl">1.28</span>, <span class="fl">1.81</span>, <span class="fl">1.66</span>, <span class="fl">1.99</span>, <span class="fl">2.07</span>, <span class="fl">1.67</span>, </span>
<span id="cb376-3"><a href="inferência-estatística.html#cb376-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.40</span>, <span class="fl">1.03</span>, <span class="fl">1.58</span>, <span class="fl">1.99</span>, <span class="fl">1.48</span>, <span class="fl">1.73</span>, <span class="fl">1.44</span>, <span class="fl">1.35</span>, <span class="fl">1.54</span>)</span></code></pre></div>
<p>Além disso, coletou um conjunto de 20 observações da população geral.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="inferência-estatística.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb377-2"><a href="inferência-estatística.html#cb377-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="fl">1.68</span>, <span class="at">sd =</span> <span class="fl">0.30</span>)</span></code></pre></div>
<p>Realize um teste de hipótese para verificar
- <span class="math inline">\(H_0: \sigma^2 = 0,30\)</span> contra <span class="math inline">\(H_1: \sigma^2 &lt; 0,30\)</span>.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="inferência-estatística.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(y, x, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb378-2"><a href="inferência-estatística.html#cb378-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-3"><a href="inferência-estatística.html#cb378-3" aria-hidden="true" tabindex="-1"></a>    F test to compare two variances</span>
<span id="cb378-4"><a href="inferência-estatística.html#cb378-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-5"><a href="inferência-estatística.html#cb378-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  y and x</span>
<span id="cb378-6"><a href="inferência-estatística.html#cb378-6" aria-hidden="true" tabindex="-1"></a>F <span class="ot">=</span> <span class="fl">1.1044</span>, num df <span class="ot">=</span> <span class="dv">30</span>, denom df <span class="ot">=</span> <span class="dv">19</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.5811</span></span>
<span id="cb378-7"><a href="inferência-estatística.html#cb378-7" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true ratio of variances is less than <span class="dv">1</span></span>
<span id="cb378-8"><a href="inferência-estatística.html#cb378-8" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb378-9"><a href="inferência-estatística.html#cb378-9" aria-hidden="true" tabindex="-1"></a> <span class="fl">0.000000</span> <span class="fl">2.148239</span></span>
<span id="cb378-10"><a href="inferência-estatística.html#cb378-10" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb378-11"><a href="inferência-estatística.html#cb378-11" aria-hidden="true" tabindex="-1"></a>ratio of variances </span>
<span id="cb378-12"><a href="inferência-estatística.html#cb378-12" aria-hidden="true" tabindex="-1"></a>           <span class="fl">1.10436</span> </span></code></pre></div>
</div>
</div>
<div id="exercícios-19" class="section level2 unnumbered hasAnchor">
<h2>Exercícios<a href="inferência-estatística.html#exercícios-19" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Uma empresa de pesquisa de mercado usou uma amostra de indivíduos para avaliar o potencial de compra de determinado produto antes e depois de as pessoas virem um novo comercial de televisão a respeito do produto. As avaliações do potencial de compra basearam-se em uma escala de 0 a 10, e os valores mais altos indicavam maior potencial de compra. A hipótese nula declarava que a avaliação média depois seria igual a avaliação média antes. A rejeição dessa hipótese demonstraria que o comercial melhorou a avaliação do potencial médio de compra. Use <span class="math inline">\(\alpha = 0,05\)</span> e os dados apresentados abaixo para testar a hipótese e comentar o valor do comercial.</li>
</ol>
<pre><code># A tibble: 8 × 3
    ind Depois Antes
  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     1      6     5
2     2      6     4
3     3      7     7
4     4      4     3
5     5      3     5
6     6      9     8
7     7      7     5
8     8      6     6</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Os preços por galçao (3,78 litros) de gasolina para carros de aluguel foram amostrados em oito grandes aeroportos. Os dados relativos às empresas de carros de aluguel Hertz e National são apresentados a seguir</li>
</ol>
<pre><code># A tibble: 8 × 3
  Aero                     Hertz National
  &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;
1 &quot;Boston&quot;                  1.55     1.56
2 &quot;Chicago&quot;                 1.62     1.59
3 &quot; Los Angeles&quot;            1.72     1.78
4 &quot;Miami&quot;                   1.65     1.49
5 &quot;Nova York (JFK)&quot;         1.72     1.51
6 &quot;Nova York (La Guardia)&quot;  1.67     1.5 
7 &quot;Orange County&quot;           1.68     1.77
8 &quot;Washington&quot;              1.52     1.41</code></pre>
<p>Use <span class="math inline">\(\alpha = 0,05\)</span> para testar a hipótese de que não há diferença entre os preços médios populacionais por galão em relação às duas empresas.</p>
<ol start="3" style="list-style-type: decimal">
<li>Na Western University, a média histórica das pontuações nos exames para obtenção de bolsas de estudo correspondente às inscrições feitas por calouros é 900. Presume-se que o desvio padrão histórico da população é <span class="math inline">\(\sigma = 180\)</span> seja conhecido. Anualmente, o vice-reitor usa uma amostra das inscrições para determinar se a média da pontuação nos exames dos calouros se modificou.
<ul>
<li>Estabeleça as hipóteses.</li>
<li>Qual é a estimação pontual e o intervalo de confiança de <span class="math inline">\(95\%\)</span> da média populacional nos exames se a seguinte amostra de tamanho 50 for observada.</li>
</ul></li>
</ol>
<pre><code># A tibble: 10 × 1
   `matrix(x, 10, 5)`[,1]  [,2]  [,3]  [,4]  [,5]
                    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1                   799. 1120.  708.  977.  775.
 2                   859.  965.  861.  847.  863.
 3                  1181.  972.  715. 1061.  672.
 4                   913.  920.  769. 1058. 1290.
 5                   923.  800.  787. 1048. 1117.
 6                  1209. 1222.  596. 1024.  698.
 7                   983.  990. 1051. 1000.  827.
 8                   672.  546.  928.  889.  816.
 9                   776. 1026.  695.  845. 1040.
10                   820.  815. 1126.  832.  885.</code></pre>
<ul>
<li>Realize um teste de hipótese para verificar a suspeita do vice-reitor. Use <span class="math inline">\(\alpha = 0,05\)</span>. Qual é a sua conclusão?</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Mensalmente o governo federal publica uma série de estatísticas sobre o número de pessoas que estão desempregadas e a média de tempo em que estão desempregadas. Em relação a novembro de 1998, o governo divulgou que a duração média nacional de desemprego era 14,6 semanas. O prefeito de Curitiba solicitou um estudo sobre a situação de desemprego na cidade. Uma amostra de 50 habitantes desempregados em Curitiba incluiu dados sobre a idade e o número de semanas em que estavam desempregados. O conjunto de dados é apresentado abaixo:</li>
</ol>
<pre><code>   Idade.1.10. Semanas.1.10. Idade.11.20. Semanas.11.20. Idade.21.30.
1           36             9           32              7           30
2           34             7           47              8           38
3           34             7           27              8           34
4           43            11           36              9           30
5           33            12           37             12           36
6           43             6           35              9           34
7           25            13           40              7           35
8           28            10           47              8           37
9           36             9           32              4           32
10          37             4           29              6           30
   Semanas.21.30. Idade.31.40. Semanas.31.40. Idade.41.50. Semanas.41.50.
1               7           36             10           32             10
2               6           41              7           44              5
3              11           37             14           33              7
4               5           33             14           28              8
5              10           41             10           45             11
6               8           40              6           35             12
7               9           38              6           41             11
8               5           36              9           31              9
9               9           31              6           34             13
10              6           42              8           30              8</code></pre>
<ul>
<li>Use estatísticas descritivas para resumir os dados.</li>
<li>Desenvolva uma estimação por intervalo de confiança de <span class="math inline">\(95\%\)</span> da média de idade e semanas desempregadas em Curitiba.</li>
<li>Realize um teste de hipótese para determinar se a duração média do desemprego em Curitiba é maior que a duração média nacional de 14,6 semanas. Use um nível de confiança de 0,01. Qual a sua conclusão.</li>
<li>Há uma relação entre a idade do individuo desempregado e o número de semanas de desemprego? Explique.</li>
</ul>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="probabilidade-e-variáveis-aleatórias.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="documentos-dinâmicos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter"],
"google": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ecr.pdf", "ecr.epub", "ecr.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
